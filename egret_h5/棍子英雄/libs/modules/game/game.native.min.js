var egret;!function(e){var t;!function(t){var n=function(t){function n(){t.call(this),this.urlData={}}__extends(n,t);var r=(__define,n);return p=r.prototype,p.proceed=function(t){function r(){var n=new e.PromiseObject;n.onSuccessFunc=function(n){t.data=n,e.Event.dispatchEvent(t,e.Event.COMPLETE)},t.dataFormat==e.URLLoaderDataFormat.BINARY?egret_native.readFileAsync(v,n,"ArrayBuffer"):egret_native.readFileAsync(v,n)}function a(){var n=e.PromiseObject.create();n.onSuccessFunc=i,n.onErrorFunc=function(){e.Event.dispatchEvent(t,e.IOErrorEvent.IO_ERROR)},egret_native.download(v,v,n)}function i(){var n;n=t.dataFormat==e.URLLoaderDataFormat.BINARY?egret_native.readFileSync(v,"ArrayBuffer"):egret_native.readFileSync(v),t.data=n,e.Event.dispatchEvent(t,e.Event.COMPLETE)}var o=this;if(t.dataFormat==e.URLLoaderDataFormat.TEXTURE)return void o.loadTexture(t);if(t.dataFormat==e.URLLoaderDataFormat.SOUND)return void o.loadSound(t);var E=t._request,v=o.getVirtualUrl(e.$getUrl(E));if(o.isNetUrl(v)){if(o.urlData.type=E.method,E.method==e.URLRequestMethod.POST&&E.data){var s=E.data;o.urlData.data=s.toString()}else delete o.urlData.data;E.requestHeaders?o.urlData.header=o.getHeaderString(E):delete o.urlData.header;var u=e.PromiseObject.create();u.onSuccessFunc=function(n){t.data=n,e.callLater(e.Event.dispatchEvent,e.Event,t,e.Event.COMPLETE)},u.onErrorFunc=function(n){e.$warn(1019,n),e.IOErrorEvent.dispatchIOErrorEvent(t)},egret_native.requireHttp(v,o.urlData,u)}else egret_native.isFileExists(v)?n.__use_asyn?r():e.$callAsync(i,o):a()},p.getHeaderString=function(e){for(var t={},n=e.requestHeaders.length,r=0;n>r;r++){var a=e.requestHeaders[r];t[a.name]=a.value}return JSON.stringify(t)},p.loadSound=function(t){function n(e){t.dispatchEvent(e)}function r(e){i(),t.dispatchEvent(e)}function a(){i(),t.data=v,e.$callAsync(function(){t.dispatchEventWith(e.Event.COMPLETE)},o)}function i(){v.removeEventListener(e.Event.COMPLETE,a,o),v.removeEventListener(e.IOErrorEvent.IO_ERROR,r,o),v.removeEventListener(e.ProgressEvent.PROGRESS,n,o)}var o=this,E=this.getVirtualUrl(t._request.url),v=new e.Sound;v.addEventListener(e.Event.COMPLETE,a,o),v.addEventListener(e.IOErrorEvent.IO_ERROR,r,o),v.addEventListener(e.ProgressEvent.PROGRESS,n,o),v.load(E)},p.loadTexture=function(t){function n(e){t.dispatchEvent(e)}function r(e){i(),t.dispatchEvent(e)}function a(){i();var n=s.data,r=new e.Texture;r._setBitmapData(n),t.data=r,e.$callAsync(function(){t.dispatchEventWith(e.Event.COMPLETE)},o)}function i(){s.removeEventListener(e.Event.COMPLETE,a,o),s.removeEventListener(e.IOErrorEvent.IO_ERROR,r,o),s.removeEventListener(e.ProgressEvent.PROGRESS,n,o)}var o=this,E=t._request,v=o.getVirtualUrl(E.url),s=new e.ImageLoader;s.addEventListener(e.Event.COMPLETE,a,o),s.addEventListener(e.IOErrorEvent.IO_ERROR,r,o),s.addEventListener(e.ProgressEvent.PROGRESS,n,o),s.load(v)},p.isNetUrl=function(e){return-1!=e.indexOf("http://")},p.getVirtualUrl=function(e){return e},n.getNetContext=function(){return null==n._instance&&(n._instance=new n),n._instance},n.__use_asyn=null==egret_native.readFileAsync?!1:!0,n}(e.HashObject);t.NativeNetContext=n,e.registerClass(n,"egret.native.NativeNetContext",["egret.NetContext"]),e.NetContext=n}(t=e["native"]||(e["native"]={}))}(egret||(egret={}));